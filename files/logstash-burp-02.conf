# Script on burp server: /etc/burp/server_script_post-01.sh:
# #!/bin/sh
# First argument: <yourburpclientname>
# cd /data/burpdata/$1/current
# awk NF=NF RS= OFS=+ backup_stats >> /var/log/burp.log
#
# Add this line /etc/burp/clientconfdir/<yourburpclientname>: 
# server_script_post=/etc/burp/server_script_post-01.sh
#
input {
  file {
    path => "/var/log/burp.log"
    tags => [ "burp-server-002" ]
  }
}

filter {
  if "burp-server-002" in [tags] {
    kv {
      field_split => "+"
      value_split => ":"
    }
    
    date {
      match => [ "time_start", "UNIX_MS" ]
    }
    
    #mutate {
    #  convert => [ "entPhySensorValue.17", "integer",
    #               "hpicfSensorStatus.1", "integer"
    #             ]
    #}
  }
}

output {
  #elasticsearch {
  #  cluster => "cluster-03"
  #}
  stdout {
    codec => rubydebug
  }
}
